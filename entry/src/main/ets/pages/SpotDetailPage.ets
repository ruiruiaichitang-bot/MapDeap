// pages/SpotDetailPage.ets
import { router } from '@kit.ArkUI';

// å®šä¹‰æˆ‘ä»¬æœŸæœ›æ¥æ”¶çš„å‚æ•°ç»“æ„
interface RouterParams {
  id: number;
  title: string;
  location: string;
}

@Entry
@ComponentV2 // ğŸ‘ˆ äº®ç‚¹ï¼šè¿™æ˜¯ V2 ç‰ˆæœ¬çš„ç»„ä»¶æ ‡å¿—
struct SpotDetailPage {
  // V2 æ–°è¯­æ³•ï¼šä½¿ç”¨ @Local ä»£æ›¿ @State ç®¡ç†ç»„ä»¶å†…éƒ¨çŠ¶æ€
  @Local title: string = 'æ™¯ç‚¹è¯¦æƒ…';
  @Local location: string = '';
  @Local imageId: number = 0;
  @Local isLiked: boolean = false; // ç‚¹èµçŠ¶æ€

  // é¡µé¢åŠ è½½æ—¶è§¦å‘
  aboutToAppear(): void {
    // è·å–ä¸Šä¸€é¡µä¼ è¿‡æ¥çš„å‚æ•°
    const params = router.getParams() as RouterParams;
    if (params) {
      this.title = params.title;
      this.location = params.location;
      this.imageId = params.id;
    }
  }

  build() {
    Column() {
      // --- 1. é¡¶éƒ¨å¯¼èˆªæ  ---
      Row() {
        // è¿”å›ç®­å¤´
        Text('<')
          .fontSize(30)
          .padding({ left: 16, right: 16 })
          .onClick(() => {
            router.back(); // ğŸ‘ˆ è¿”å›ä¸Šä¸€é¡µ
          })

        Text(this.title)
          .fontSize(20)
          .fontWeight(FontWeight.Bold)
          .layoutWeight(1) // æ’‘æ»¡ä¸­é—´
          .textAlign(TextAlign.Center) // æ–‡å­—å±…ä¸­

        // å ä½ç¬¦ï¼Œä¸ºäº†è®©æ ‡é¢˜è§†è§‰å±…ä¸­
        Text('  ').width(50)
      }
      .height(56)
      .width('100%')
      .border({ width: { bottom: 1 }, color: '#EEE' })

      // --- 2. å†…å®¹åŒºåŸŸ ---
      Column({ space: 20 }) {
        // å¤§å›¾
        Image($r('app.media.background')) // æš‚æ—¶è¿˜ç”¨è¿™ä¸ªå›¾ï¼Œä»¥åæ¢
          .width('100%')
          .height(250)
          .objectFit(ImageFit.Cover)
          .borderRadius(16)
          .shadow({ radius: 10, color: '#33000000' })

        // åœ°ç‚¹ä¿¡æ¯
        Row() {
          Text('ğŸ“ ' + this.location)
            .fontSize(16)
            .fontColor('#666')
            .backgroundColor('#F5F5F5')
            .padding({ left: 10, right: 10, top: 6, bottom: 6 })
            .borderRadius(20)
        }
        .width('100%')

        // ä»‹ç»æ–‡æ¡ˆ
        Text('è¿™é‡Œæ˜¯è¯¦ç»†ä»‹ç»...\nArkTS V2 å¸¦æ¥çš„ @Local è£…é¥°å™¨è®©çŠ¶æ€ç®¡ç†æ›´ç›´è§‚ï¼Œåªæœ‰çœŸæ­£å˜åŒ–çš„æ•°æ®æ‰ä¼šè§¦å‘ UI åˆ·æ–°ï¼Œæ€§èƒ½æ›´å¼ºã€‚')
          .fontSize(16)
          .lineHeight(26)
          .fontColor('#333')

        // --- 3. äº’åŠ¨æŒ‰é’® (æµ‹è¯• V2 çŠ¶æ€) ---
        Button(this.isLiked ? 'å·²æ”¶è— â¤ï¸' : 'æ”¶è—æ™¯ç‚¹ ğŸ¤')
          .onClick(() => {
            this.isLiked = !this.isLiked; // ç›´æ¥ä¿®æ”¹ï¼ŒUI è‡ªåŠ¨åˆ·æ–°
          })
          .width('100%')
          .height(45)
          .backgroundColor(this.isLiked ? '#FFEBEE' : '#222')
          .fontColor(this.isLiked ? Color.Red : Color.White)
          .margin({ top: 20 })
      }
      .padding(20)
    }
    .width('100%')
    .height('100%')
    .backgroundColor(Color.White)
  }
}